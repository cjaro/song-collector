<!-- start Search Bar Area -->
<div class="col-md-12">
  <div class="search-bar text-center">
    <span class="glyphicon glyphicon-filter" aria-hidden="true" ng-click="cc.expandFilter()"></span>
    <input type="text" class="search" placeholder="search..." ng-model="search.$"/>
    <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
    <div ng-show="cc.spanClicked" id="filterExpanded">
      <input type="text" class="search" placeholder="search titles..." ng-model="search.song_title" />
      <input type="text" class="search" placeholder="search tone sets..." ng-model="search.tone_set" />
      <!-- <input type="text" ng-model="searchForm" ng-change="cc.searchPage(searchForm)">
      <select class="form-control" ng-model="searchForm.searchFilter">
        <option value="song_title">Song Title</option>
        <option value="tone_set">Tone Set</option>
        <option value="scale_mode">Scale / Mode</option>
        <option value="teachable_elements">Teachable Elements</option>
      </select>
      <button class="btn" ng-click="cc.searchPage(searchForm)">Search</button> -->
    </div>
  </div>
</div>
<!-- end Search Bar area -->

<div ng-if="cc.viewMore" class="backgroundDark">

</div>

<!-- Area for showing all songs or songs alongside an individual song-->
<div class="col-sm-12" id="songInfoContainer">

  <!-- dynamic-width div for song cards -->
  <div ng-class="['container-fluid', 'card-holder', cc.songClicked ? 'col-sm-3':'col-md-12']">
    <div ng-class="cc.songClicked ? card : row">


      <div class="text-center panel songCount" id="toolbar">
        Songs in collection: {{cc.songs.list.length}}
      </div>
      <!-- start container for first "add song" card -->
      <div ng-if="!cc.songClicked" class="card vertical-center" id="first-card">
        <a href="#!new"><div class="circle-around-plus"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></div></a>
      </div>
      <!-- end container for first "add song" card -->

      <!-- for users who have just logged in and don't yet have songs in the db -->

      <!-- start container for all song cards -->

      <!-- ng-repeat="song in cc.filteredResults.list"  -->
      <div class="card" ng-repeat="song in cc.songs.list | filter:search" ng-click="cc.showSong(song.id)">
        <h3 class="text-center">{{song.song_title}}</h3>
        <p><b>Tone Set: </b><span  ng-bind-html="song.tone_set"></span></p>
        <p><b>Scale / Mode:</b> {{song.scale_mode}}</p>
        <p><b>Teachable Element:</b> <span ng-repeat="element in song.teachableElements">{{element.teachable_elements}},</span></p>
      </div>
      <!-- end container for all song cards -->

    </div>
  </div>



  <div ng-if="cc.songClicked" class="col-sm-9 card-holder no-gutter">

    <div class="text-right panel" id="toolbar">
      <div class="col-sm-6 half-gutter text-left">
        <input class="form-control" id="songTitle" ng-model="cc.oneSong.details.song_title"/>
      </div>
      <!-- end song title section -->

      <!-- start toolbar section -->
      <button ng-click="cc.songClicked=false" class="btn btn-primary"><span class="glyphicon glyphicon-th-large" aria-hidden="true"></span></button>
      <button type="button" class="btn btn-primary" ng-click="cc.saveSongChanges(cc.oneSong.details)"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span></button>
      <button type="button" popover-placement="bottom-right" uib-popover-template="cc.dynamicPopover.templateUrl" popover-title="{{cc.dynamicPopover.title}}" popover-trigger="'outsideClick'" class="btn btn-default"><span class="glyphicon glyphicon-share" aria-hidden="true"></span></button>
      <button type="button" popover-placement="bottom-right" uib-popover-template="cc.deletePopover.templateUrl" popover-title="{{cc.deletePopover.title}}" popover-trigger="'outsideClick'" class="btn btn-default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button>
      <a type="button" class="btn btn-primary" href="#!print"><span class="glyphicon glyphicon-print" aria-hidden="true"></span></a>
      <!-- onclick="window.print()" target="_blank" -->
      <!-- end toolbar section -->

      <!-- start Share popover template -->
      <script type="text/ng-template" id="sharePopover.html">
        <div>{{cc.dynamicPopover.content}}</div>
        <form>
          <div class="input-group">
            <input type="text" class="form-control" ng-model="home.newEvent" placeholder="Email Address">
            <span class="input-group-btn">
              <button class="btn btn-default" ng-click="home.nameEvent()" type="submit"><strong>Go!</strong></button>
            </span>
          </div>
        </form>
      </script>
      <!-- end Share popover template -->

      <!-- start Delete popover template -->
      <script type="text/ng-template" id="deletePopover.html">
        <div>{{cc.deletePopover.content}}</div>
        <form>
          <div class="input-group">
            <button class="btn btn-danger" ng-click="cc.deleteFunction(cc.oneSong.details.id)" type="submit"><strong>Delete!</strong></button>
          </div>
        </form>
      </script>
      <!-- end Delete popover template -->
    </div>

    <!-- start div for song info column -->
<div class="col-sm-8 card-holder">

  <form class="form-horizontal">

    <div class="form-group">
      <label for="toneSet" class="col-sm-4 control-label no-gutter">Tone Set</label>
      <div class="col-sm-8 half-gutter">
        <ng-quill-editor class="form-control" theme="bubble" ng-model="cc.oneSong.details.tone_set" placeholder="override default placeholder">
          <ng-quill-toolbar>
            <div id="ng-quill-toolbar">
              <span class="ql-formats">
                <button class="ql-bold" ng-attr-title="{{'Bold'}}"></button>
                <button class="ql-italic" ng-attr-title="{{'Italic'}}"></button>
                <button class="ql-underline" ng-attr-title="{{'Underline'}}"></button>
              </span>
            </div>
          </ng-quill-toolbar>
        </ng-quill-editor>
      </div>
    </div>

    <div class="form-group">
      <label for="scaleMode" class="col-sm-4 control-label no-gutter">Scale / Mode</label>
      <div class="col-sm-8 half-gutter">
        <select name="scaleMode" ng-model="cc.oneSong.details.scale_mode_id" class="form-control" placeholder="Scale / Mode" ng-options="scaleMode.scale_mode for scaleMode in cc.dropdowns.scaleMode track by cc.oneSong.details.scale_mode_id">
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="teachableElements" class="col-sm-4 control-label no-gutter">Teachable Elements</label>
      <div class="col-sm-8 half-gutter">
        <div ng-dropdown-multiselect options="cc.dropdowns.teachableElements" selected-model="cc.oneSong.details.teachable_elements_id_group" extra-settings="cc.teachableElementsSettings" translation-texts="cc.teachableElementsCustomTexts"></div>
      </div>
      <!-- {{cc.oneSong.details.teachable_elements_id_group}} -->
    </div>

    <div class="form-group" ng-click="cc.findFocus('rhythm')">
      <label for="rhythm" class="col-sm-4 control-label no-gutter">Rhythm</label>
      <div class="col-sm-8 half-gutter">
        <input ng-if="cc.editingRhythm" type="text" class="form-control" ng-model="cc.oneSong.details.rhythm" placeholder="Rhythm" ng-change="cc.updateRhythmDisplay(cc.oneSong.details.rhythm)" ng-blur="cc.loseFocus('rhythm')" focusing>
        <div class="display">
          <span ng-repeat="component in cc.oneSong.details.rhythmArray track by $index">
            <span ng-class="{'music-font': $index % 2==0}">{{component}}</span>
          </span>
        </div>
      </div>
    </div>

    <div class="form-group" ng-click="cc.findFocus('extractableRhythm')">
      <label for="extractableRhythms" class="col-sm-4 control-label no-gutter">Extractable Rhythms</label>
      <div class="col-sm-8 half-gutter">
        <input ng-if="cc.editingExtractableRhythm" type="text" class="form-control" ng-model="cc.oneSong.details.extractable_rhythms" placeholder="Extractable Rhythm" ng-change="cc.updateExtractableRhythmDisplay(cc.oneSong.details.extractable_rhythms)" ng-blur="cc.loseFocus('extractableRhythm')" focusing>
        <div class="display">
          <span ng-repeat="extract in cc.oneSong.details.extractableRhythmArray track by $index">
            <span ng-class="{'music-font': $index % 2==0}">{{extract}}</span>
          </span>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="extractableMelodies" class="col-sm-4 control-label no-gutter">Extractable Melodies</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.extractable_melodies"/>
      </div>
    </div>

    <div class="form-group">
      <label for="meter" class="col-sm-4 control-label no-gutter">Meter</label>
      <div class="col-sm-8 half-gutter">
        <select name="formType" ng-model="cc.oneSong.details.meter_id" class="form-control" placeholder="Meter" ng-options="meter.meter for meter in cc.dropdowns.meter">
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="source" class="col-sm-4 control-label no-gutter">Verses</label>
      <div class="col-sm-8 half-gutter">
        <textarea class="form-control" rows="5">{{cc.oneSong.details.verses_note}}</textarea>
      </div>
    </div>

    <div class="form-group">
      <label for="intervalNoteGroup" class="col-sm-4 control-label no-gutter">Intervals / Note Group</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" "cc.oneSong.details.intervals_note_groups"/>
      </div>
    </div>

    <div class="form-group">
      <label for="phrases" class="col-sm-4 control-label no-gutter">Phrases</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.phrases"/>
      </div>
    </div>

    <div class="form-group">
      <label for="melodicForm" class="col-sm-4 control-label no-gutter">Melodic Form</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.melodic_form"/>
      </div>
    </div>

    <div class="form-group">
      <label for="rhythmicForm" class="col-sm-4 control-label no-gutter">Rhythmic Form</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.rhythmic_form"/>
      </div>
    </div>

    <div class="form-group">
      <label for="formType" class="col-sm-4 control-label no-gutter">Form Type</label>
      <div class="col-sm-8 half-gutter">
        <select name="formType" ng-model="cc.oneSong.details.formType" class="form-control" placeholder="Form Type" ng-options="formType.form_type for formType in cc.dropdowns.formType">
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="songType" class="col-sm-4 control-label no-gutter">Song Type</label>
      <div class="col-sm-8 half-gutter">
        <select name="formType" ng-model="cc.oneSong.details.songType" class="form-control" placeholder="Song Type" ng-options="songType.song_type for songType in cc.dropdowns.songType">
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="cultureOrigin" class="col-sm-4 control-label no-gutter">Culture / Origin</label>
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.culture_origin"/>
      </div>
    </div>

    <div class="form-group">
      <label for="language" class="col-sm-4 control-label no-gutter">Language</label>
      <div class="col-sm-8 half-gutter">
        <select name="formType" ng-model="cc.oneSong.details.language" class="form-control" placeholder="Language" ng-options="language.language for language in cc.dropdowns.language">
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="csp" class="col-sm-4 control-label no-gutter">CSP</label>
      <!-- NOTE: CSP stands for: comfortable starting pitch -->
      <div class="col-sm-8 half-gutter">
        <input class="form-control" ng-model="cc.oneSong.details.csp"/>
      </div>
    </div>

    <div class="form-group">
      <label for="other" class="col-sm-4 control-label no-gutter">Other</label>
      <div class="col-sm-8 half-gutter">
        <textarea class="form-control" rows="3">{{cc.oneSong.details.other_note}}</textarea>
      </div>
    </div>

    <div class="form-group">
      <label for="source" class="col-sm-4 control-label no-gutter">Source</label>
      <div class="col-sm-8 half-gutter">
        <textarea class="form-control" rows="3">{{cc.oneSong.details.source_note}}</textarea>
      </div>
    </div>

  </form>
</div>
<!-- end div for song info -->

<!-- attachments div -->
<div class="col-sm-4">
  <!-- notation attachments -->
  <div class="form-group">
    <label for="notation" class="col-sm-12 control-label no-gutter">Music Notation</label>
    <div> <!-- existing attachments -->
      <img class="small" ng-click="cc.viewMoreOnClick(true, 'notation', $index)" ng-repeat="notation in cc.attachments.notation" ng-src="{{notation.image_url}}"/>
    </div>
    <div class="col-sm-12 half-gutter">
      <button class="btn btn-primary" ng-click="cc.notationUpload(cc.oneSong.details.id)">Upload</button>
      <div style="margin-top:10px;" ng-if="cc.notationUploaded.notation.length > 0">
        <!-- Show the thumbnail only when the picture is uploaded -->
        <!-- <a href="{{cc.filesUploaded.list[0].url}}" class="thumbnail"> -->
        <!-- the picture is rendered with width: 500 and sharpened -->
        <img class="small" ng-src="{{cc.notationUploaded.notation[0].url}}">
        <!-- </a> -->
        <!-- <button ng-click="cc.removeImage()">Delete</button> -->
        <!-- ^^^ will need to be an ng-repeat with multiple files ^^^ -->
      </div>
    </div>
  </div>

  <!-- other attachments -->
  <div class="form-group">
    <label for="attachments" class="col-sm-12 control-label no-gutter">Attachments</label>
    <div> <!-- existing attachments -->
      <img class="small" ng-click="cc.viewMoreOnClick(true, 'attachments', $index)" ng-repeat="photo in cc.attachments.attachments" ng-src="{{photo.image_url}}"/>
    </div>
    <div class="col-sm-12 half-gutter">
      <button class="btn btn-primary" ng-click="cc.fileUpload(cc.oneSong.details.id)">Upload</button>
      <div style="margin-top:10px;" ng-if="cc.filesUploaded.attachments.length > 0">
        <!-- Show the thumbnail only when the picture is uploaded -->
        <!-- the picture is rendered with width: 500 and sharpened -->
        <img class="small" ng-src="{{cc.filesUploaded.attachments[0].url}}">
        <!-- ^^^ will need to be an ng-repeat with multiple files ^^^ -->
      </div>
    </div>
  </div>
</div>
<!-- end attachments div -->
</div>

<div ng-if="cc.viewMore" class="imageModule text-center" ng-click="cc.viewMoreOnClick(false)">
  <img style="max-width:100%; max-height:100%;" ng-src="{{cc.lightboxImage}}" />
</div>
</div>
